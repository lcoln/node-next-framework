# node-framework
1. 项目远程目录 /www.upgrade/node-next-framework
2. 本地文件夹名称恒为node-next-framework
3. 如果工程里无projects目录，请新建projects目录，运行项目则是需要将项目clone进projects目录
4. 实例化后全局默认挂载以下参数
> 1. APP // 框架实例，可以通过APP.get(key)获取全局配置
> 2. Controller // 控制类, extends该控制类可获取session等实例
> 3. Utils // 全局工具函数库
> 4. Sec // 全局加密库
# node项目框架

## Build Setup

``` bash

# 安装依赖
npm install

# 本地调试
1. pm2 start --name projectName projects/${project}/app.js --watch
or
2. node projects/${project}/app.js
注: 推荐第一种方式, 需全局安装pm2 npm install pm2 -g
3. open browser with localhost://${your project port}

# 创建redis主从配置文件
#!/bin/bash
echo "sentinel myid cf1de9ff79255c919b9d2f3bc8afdc2b4b9d0c74
sentinel monitor mymaster 127.0.0.1 6379 2
sentinel down-after-milliseconds mymaster 60000
sentinel config-epoch mymaster 0
# Generated by CONFIG REWRITE
port 26379
dir "/usr/local/etc"
sentinel leader-epoch mymaster 0
sentinel known-slave mymaster 127.0.0.1 6380
sentinel current-epoch 0" > /usr/local/etc/sentinel.conf 

# 连接redis
#!/bin/bash
install redis redis-sentinel
sudo -S nohup redis-sentinel /usr/local/etc/sentinel.conf &
nohup redis-server --port 6379 &
nohup redis-server --port 6380 &
redis-cli -p 6380
> SLAVEOF 127.0.0.1 6379  // master: 6379. slave: 6380

# 连接mysql
install mysql
mysqld
连接不上时查看
1. 数据库服务器3306端口是否放行
2. 去除my.cnf bind-address=127.0.0.1
```
## 工程目录设计规范
> node-next-framework // 公共框架层
> 1. core                // 架构核心实现
> 2. libs          // 公用工具函数库
> 3. projects                // 业务工程目录
>> projectName          // 工程目录名
>>> 1. config               // 数据库redis等配置存储
>>> 2. apps                // 接口路由(mvc)
>>>> InterfaceName     // 接口目录
>>>>> constroller      // 控制层, 主要负责数据接收, 业务处理, 调取model层进行数据获取, 最终返回数据请求处理结果
>>>>> model            // 数据层, 主要负责转发接口，进行数据库操作, 最终返回数据给控制层
>>> 3. src                  // 前端开发资源
>>>> pages              // 前端路由目录